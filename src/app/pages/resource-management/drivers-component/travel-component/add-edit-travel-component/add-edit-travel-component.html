<app-h-modal [headerTitle]="isEdit ? 'تعديل مسار' : 'إضافة مسار'" (closeEvent)="close()">

    <form [formGroup]="form" class="p-3" dir="rtl">

        <!-- Row: Type + Category -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">نوع العملية <span class="text-danger">*</span></label>

                <select class="form-control" formControlName="type">
                    <option value="" disabled>اختر نوع العملية</option>
                    <option *ngFor="let item of processTypeItems" [value]="item.value">
                        {{ item.label }}
                    </option>
                </select>

                <div class="text-danger mt-1" *ngIf="form.get('type')?.touched && form.get('type')?.hasError('required')">
                    نوع العملية مطلوب
                </div>
            </div>

            <div class="col-md-6">
                <label class="form-label">تصنيف المادة <span class="text-danger">*</span></label>

                <select class="form-control" formControlName="category">
                    <option value="" disabled>اختر التصنيف</option>
                    <option *ngFor="let mc of materialCategoryItems" [value]="mc.value">
                        {{ mc.label }}
                    </option>
                </select>

                <div class="text-danger mt-1" *ngIf="form.get('category')?.touched && form.get('category')?.hasError('required')">
                    التصنيف مطلوب
                </div>
            </div>
        </div>

        <!-- Row: Start Location + Destination -->
        <div class="row mb-3">
            <div class="col-md-6 text-end">
                <label class="form-label">منطقة الانطلاق <span class="text-danger">*</span></label>
                <input type="text" formControlName="startLocation" class="form-control text-end"
                       [ngClass]="{'is-invalid': form.get('startLocation')?.touched && form.get('startLocation')?.invalid}" />

                <div class="invalid-feedback text-end" *ngIf="form.get('startLocation')?.hasError('required')">
                    هذا الحقل مطلوب.
                </div>
            </div>

            <div class="col-md-6 text-end">
                <label class="form-label">الوجهة</label>
                <input type="text" formControlName="destination" class="form-control text-end" />
            </div>
        </div>

        <!-- Row: Plate Number + Amount -->
        <div class="row mb-3">
            <div class="col-md-6">
                <label class="form-label">رقم اللوحة</label>
                <input id="plateNumber" type="text" class="form-control" formControlName="plateNumber" placeholder="أدخل رقم اللوحة">

                <div class="text-danger mt-1" *ngIf="form.get('plateNumber')?.touched && form.get('plateNumber')?.hasError('required')">
                    رقم اللوحة مطلوب
                </div>
            </div>

            <div class="col-md-6 text-end">
                <label class="form-label">التكلفة <span class="text-danger">*</span></label>
                <input type="number" formControlName="amount" class="form-control text-end" placeholder="0.00"
                       [ngClass]="{'is-invalid': form.get('amount')?.touched && form.get('amount')?.invalid}" />

                <div class="invalid-feedback text-end" *ngIf="form.get('amount')?.hasError('required')">
                    التكلفة مطلوبة.
                </div>

                <div class="invalid-feedback text-end" *ngIf="form.get('amount')?.hasError('min')">
                    التكلفة يجب أن تكون أكبر من صفر.
                </div>
            </div>
        </div>

        <!-- Row: Start Date + End Date -->
        <div class="row mb-3">
            <div class="col-md-6 text-end">
                <label class="form-label">تاريخ الانطلاق <span class="text-danger">*</span></label>
                <input type="date" formControlName="startDate" class="form-control text-end"
                       [ngClass]="{'is-invalid': form.get('startDate')?.touched && form.get('startDate')?.invalid}">
            </div>

            <div class="col-md-6 text-end">
                <label class="form-label">تاريخ الوصول</label>
                <input type="date" formControlName="endDate" class="form-control text-end">
            </div>
        </div>

        <!-- Notes -->
        <div class="mb-3 text-end">
            <label class="form-label">ملاحظات</label>
            <textarea formControlName="notes" class="form-control text-end" placeholder="ملاحظات إضافية"></textarea>
        </div>

        <!-- Buttons -->
        <div class="d-flex justify-content-end mt-3">
            <button type="button" class="btn btn-primary ms-2" (click)="submit()">
                {{ isEdit ? 'تحديث' : 'حفظ' }}
            </button>
            <button class="btn btn-secondary" type="button" (click)="close()">إلغاء</button>
        </div>

    </form>
</app-h-modal>
